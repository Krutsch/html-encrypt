<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Hidden Page</title>
    <style>
      body {
        font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
          Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue",
          sans-serif;
        background-color: #c0ffee;
      }
      h1 {
        text-align: center;
      }
      img {
        display: block;
        margin: auto;
        max-height: 50vh;
        max-width: 100%;
      }
    </style>
  </head>
  <body>
    <script type="module">
      const esm = ({ raw }, ...vals) =>
        URL.createObjectURL(
          new Blob([String.raw({ raw }, ...vals)], {
            type: "application/javascript",
          })
        );
      const { handleDecryptionOfPage } = await import(
        esm`const{subtle:u}=crypto,h=4;export const IV_BITS=16*8,ENCRYPTION_ALGO="AES-CBC",HexEncoder={parse:function(e){if(e.length%2!==0)throw"Invalid hexString";const n=new Uint8Array(e.length/2);for(let t=0;t<e.length;t+=2){const r=parseInt(e.substring(t,t+2),16);if(isNaN(r))throw"Invalid hexString";n[t/2]=r}return n},stringify:function(e){const n=[];for(let t=0;t<e.length;++t){let r=e[t].toString(16);r.length<2&&(r="0"+r),n.push(r)}return n.join("")}};async function w(e,n){const t=IV_BITS/h,r=HexEncoder.parse(e.substring(0,t)),c=e.substring(t),s=await u.importKey("raw",HexEncoder.parse(n),ENCRYPTION_ALGO,!1,["decrypt"]),i=await u.decrypt({name:ENCRYPTION_ALGO,iv:r},s,HexEncoder.parse(c));return new TextDecoder().decode(new Uint8Array(i))}function l(e,n){return d(e,n,1e3,"SHA-1")}function p(e,n){return d(e,n,14e3,"SHA-256")}function f(e,n){return d(e,n,585e3,"SHA-256")}async function d(e,n,t,r){const c=await u.importKey("raw",new TextEncoder().encode(e),"PBKDF2",!1,["deriveBits"]),s=await u.deriveBits({name:"PBKDF2",hash:r,iterations:t,salt:new TextEncoder().encode(n)},c,256);return HexEncoder.stringify(new Uint8Array(s))}async function y(e,n,t,r=0,c=""){const s=e.substring(0,64),i=e.substring(64);if(await signMessage(n,i)!==s){if(c=c||n,r===0){const o=await f(c,t);return y(e,o,t,r+1,c)}if(r===1){let o=await p(c,t);return o=await f(o,t),y(e,o,t,r+1,c)}return{success:!1,message:"Signature mismatch"}}return{success:!0,decoded:await w(i,n)}}async function H(e,n,t){return await S(e,n,t)?{isSuccessful:!0,hashedPassword:e}:{isSuccessful:!1,hashedPassword:e}}async function S(e,n,t){const r=await y(n,e,t);return r.success?(import("https://unpkg.com/hydro-js@1.5.19/dist/library.js").then(({render:c,html:s,setReuseElements:i})=>{i(!1);const a=s({raw:r.decoded}),o=a.querySelector("html")||a;c(o,document.documentElement)}).catch(()=>{document.write(r.decoded),document.close()}),!0):!1}export async function hashPassword(e,n){let t=await l(e,n);return t=await p(t,n),f(t,n)}export async function signMessage(e,n){const t=await u.importKey("raw",HexEncoder.parse(e),{name:"HMAC",hash:"SHA-256"},!1,["sign"]),r=await u.sign("HMAC",t,new TextEncoder().encode(n));return HexEncoder.stringify(new Uint8Array(r))}export async function handleDecryptionOfPage(e,n,t){const r=await hashPassword(e,t);return H(r,n,t)}`
      );
      const $ = document.querySelector.bind(document);
      const encryptedMsg =
        "b280ac3b684c4c4178a87fbbca7866bfdb27ea20f549d38f43c92f634f820c9a4928616d73fd11b75c7030ff3e8f6f61d66ee7935b1c7905a899fcc8985a03df0aaa07472824f6cfa26753ca0a309b5cf1e0bed0065d1d6b9722cf5c2570cdb7a3304a7c584fcf6760733d6ab1bc43d5535f5bb147f0d4e56513b4fe571896d27c2679207f526b6b81773e198311c61f6dc8628addcc80aef5e17f42d638b55d2399b89227ecd6a347286d25583e99c80f1156479d432d0547c642d0334ec737a3e0d9ea2777b53e4c4966686f98eb043869899152683e1c590f3e65f4e4d6479594621def7cc767637d302c6940d7dfff7db5cdb247e23464210d7b7072d735a2d0c5bf0a5c652942c0469e6986c26d533241acf2f547d41b7a38c65f8410d27e95464aa3b59d93f69b119255048e9141f4ce2831b79c29d5bf1e6ddc6e87077c76ddfc1562262935f4c4d4b60551738541555e1df064f60809d97172416b47438099b4b26be49b7285cbd6ec328d8b9502ae874738d0a65d0280c0b96606899d31102be19ac60916f31e608353b0ff65328cd860f5618a20b07cfdd8a4ec362b70a233bdf871b374719181e03d7f929d6ddd5509931d63d1743972579cd07b87dcd5300a71fa846e7f1da735efc41adc1ddd8fdd9632eb84c7b2373aeeacc25dec8fc2f7cd004dc0cf5b687f63b41425714cff7cbe04f0332e5f337dbf0c0ed4adb25f8cae42350db4458440f3e1d396f03b3627c5bcbebec5f116b8dfd1c50ea56d29a25159d7f64627f5567530508f5b4660856e0317ac309e162f300aaf96f146950a97f9514242c772b86c53d574becd04e75250769739ab0dbdfc6c777703bd9cd7bef5e84e60a34fc399dfc7830863d5b61481f4f583f641ea9cea0aafa1c9a6eae776156c53f8904bf67f386e39619c2fb48403c4f50e9c210e7c1def81a6843c101b2f4f81a00b82f97a015c08211dca5a9dcc5093cd3f2fe00dfdea6eddbbba1f7b4010cacab9f1b4f7f4f1775f577e5beafc4071292e3ed12e3d10e002099e833b2e6bf62434b24a837dae13fce4eaeccebf44ef52bb63b5a8a3aadef1af6698c7b720dda16ddf1b7d8ef79d2595a95556b5b73228f0a108532bc81215102400ee8db701709993decc2c13602e1836cb9388150251d260b082a7101437f7b92f1000fdb71e87f4324b126542d45e62c2f8cf4c19503c187e30e66fcc9d5dbed47294af372e24dfb41e85ac7a8ce727476198add3d3faf7f6efa8d60ef749c72d0f5e617ec8305d71263e7c925853ba842d10c029b1356236a2482bf77dc1382f622596e958b88050f12a59da367a3a3f1e341624c6389c39b87588bb3186b37c3005850afa3e7996d9076e08f2509eeb5807823c37e7e0829cb723579d57380eb1305fa4f68d60c72a8bcd37833a9b6a366de723b9187e12a079";
      const salt = "7449b49ad78ee2b631f4489839f73af2";
      const main = $("main");
      $("form").addEventListener("submit", async function (e) {
        e.preventDefault();
        const password = $("input").value;
        const { isSuccessful } = await handleDecryptionOfPage(
          password,
          encryptedMsg,
          salt
        );
        if (!isSuccessful) {
          main?.classList.remove("shake");
          main?.offsetWidth;
          main?.classList.add("shake");
        }
      });
    </script>
    <script src="https://cdn.twind.style" crossorigin></script>
    <style>
      html {
        height: 100%;
      }
      body {
        display: block;
        height: 100%;
        width: 100%;
        background-color: rgb(17 24 39);
        color: rgb(241 245 249);
        font-size: 1rem;
        line-height: 1.5rem;
        overflow-x: hidden;
      }
      @keyframes shake {
        0% {
          transform: translateX(0);
        }
        6.5% {
          transform: translateX(-6px) rotateY(-9deg);
        }
        18.5% {
          transform: translateX(5px) rotateY(7deg);
        }
        31.5% {
          transform: translateX(-3px) rotateY(-5deg);
        }
        43.5% {
          transform: translateX(2px) rotateY(3deg);
        }
        50% {
          transform: translateX(0);
        }
      }
      .shake {
        animation: shake 2s;
      }
    </style>
    <main class="flex h-full place-content-center place-items-center">
      <div class="w-[37rem] rounded bg-slate-800 px-5 py-10 shadow-xl">
        <h1 class="mb-2 text-3xl font-bold">Password</h1>
        <form>
          <label class="grid"
            ><span class="text-slate-300 mb-1.5 mt-4"
              >Please enter the password <strong>admin</strong></span
            >
            <input
              type="password"
              name="password"
              aria-label="Password"
              autocomplete="current-password"
              required
              autofocus
              class="appearance-none rounded border border-slate-400 bg-slate-900 px-3 py-2.5 focus-visible:border-teal-600 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-cyan-600"
          /></label>
          <button
            type="submit"
            class="mt-4 w-full rounded bg-slate-100 py-3 font-bold text-slate-800 !bg-slate-100"
          >
            Login
          </button>
        </form>
      </div>
    </main>
  </body>
</html>
