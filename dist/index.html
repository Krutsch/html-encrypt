<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Demo html-encrypt</title><link rel="icon" href="./favicon.png"><style>body{font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;background-color:#c0ffee}h1{text-align:center}img{display:block;margin:auto;max-height:50vh;max-width:100%}</style></head><body><script type="module">const esm = ({ raw }, ...vals) =>URL.createObjectURL(new Blob([String.raw({ raw }, ...vals)], {type: "application/javascript",}),);const { handleDecryptionOfPage } = await import(esm`const{subtle:o}=crypto,i={1:1e3,2:14e3,3:585e3},p="SHA-256",w=4;export const IV_BITS=128,ENCRYPTION_ALGO="AES-CBC",HexEncoder={parse(t){if(t.length%2!==0)throw"Invalid hexString";const n=new Uint8Array(t.length/2);for(let e=0;e<t.length;e+=2){const r=parseInt(t.substring(e,e+2),16);if(isNaN(r))throw"Invalid hexString";n[e/2]=r}return n},stringify(t){return Array.from(t,n=>n.toString(16).padStart(2,"0")).join("")}};async function h(t,n){const e=IV_BITS/w,r=HexEncoder.parse(t.substring(0,e)),c=t.substring(e),s=await o.importKey("raw",HexEncoder.parse(n),ENCRYPTION_ALGO,!1,["decrypt"]),a=await o.decrypt({name:ENCRYPTION_ALGO,iv:r},s,HexEncoder.parse(c));return new TextDecoder().decode(new Uint8Array(a))}async function l(t,n,e,r){const c=await o.importKey("raw",new TextEncoder().encode(t),"PBKDF2",!1,["deriveBits"]),s=await o.deriveBits({name:"PBKDF2",hash:r,iterations:e,salt:new TextEncoder().encode(n)},c,256);return HexEncoder.stringify(new Uint8Array(s))}async function u(t,n,e,r=p){return l(t,n,e,r)}async function f(t,n,e,r=0,c=""){const s=t.substring(0,64),a=t.substring(64);if(await signMessage(n,a)!==s){if(c||=n,r===0){const d=await u(c,e,i[3]);return f(t,d,e,1,c)}if(r===1){let d=await u(c,e,i[2]);return d=await u(d,e,i[3]),f(t,d,e,2,c)}return{success:!1,message:"Signature mismatch"}}return{success:!0,decoded:await h(a,n)}}async function m(t,n,e){const r=await f(n,t,e);if(!r.success)return!1;try{const{render:c,html:s,setReuseElements:a}=await import("https://cdn.jsdelivr.net/npm/hydro-js");a(!1);const y=s({raw:r.decoded});c(y.querySelector("html")||y,document.documentElement)}catch{document.write(r.decoded),document.close()}return!0}async function A(t,n,e){return{isSuccessful:await m(t,n,e),hashedPassword:t}}export async function hashPassword(t,n){let e=await u(t,n,i[1],"SHA-1");return e=await u(e,n,i[2],"SHA-256"),u(e,n,i[3])}export async function signMessage(t,n){const e=await o.importKey("raw",HexEncoder.parse(t),{name:"HMAC",hash:p},!1,["sign"]),r=await o.sign("HMAC",e,new TextEncoder().encode(n));return HexEncoder.stringify(new Uint8Array(r))}export async function handleDecryptionOfPage(t,n,e){const r=await hashPassword(t,e);return A(r,n,e)}
`);const encryptedMsg = "741107bda7e3d5e14b6e05bfcc3b971fedc278c7318af2e4a6a5d82f4c93088f2a7d9b21e685dcb6bdf7fc737be73b83d5a38044e8108334f17804b5ff60bd5d78158468fc70db7dece360a5a9e05050adc2cfe83e96a255f4c1f6163ac3afa765dd8b023fa52a18bcdf13dc446bc2826f73f0eb58fd8a34699287b41f58b04a616ff3dac8003a8284e8853cea9c6a319a12097e6626743663ef0b1ecb61b67771fcf10c3cb88d6e2447a482734697270265ea0314bd1d3cc512a2861d29e478ba7d558a77d6d95db64eac4606ef2e330ab431e66def4cf9d5563b193bd56bb98cd2edcc3402dcce91b397c0aa4620b4d8d10e41bf5b93029aaef5fb92dc3e2a87eac343b062d591542bdcb19f98e34d2df5b38288d9eb33cd4732eddc89336f2620f2e1d603ed556ff51dd492f0bc8ad96c65851026f53b07c78e97ba2984af80ab5650ddb8d6ae4484ca1ccdb8e1490c5b6e5d1a3fac28e22b40883dbfd2e2cd269651f6d4c8fcba4ba5171c0316610945d02468e51525c57dec2e35696c4c83e1143b41a8bbc47a76680f10bbb6d60f2b56d29ca230e52dbe025e2140b81dde6589fd920323fd048db4c43cae16f79b395b628559959c950a360295e31cc2aaf2f80f13590acd10a3879fb8ebe8eda5f21ec4702f807e6feacfc9e7309163253f8b9db73439f21a8b062ef1e238eadd86c13ee9a8cd9d73a56eee95a1eb3f568a22c153ae2be07e342758b430a060e89d598cd5c57427fe468cd24d803ab920e80327bf7d74120bbc97a4d73c9a32f395c0534a24930ec1889b4899368badfc7c7466a3eefe916b86b32eb8f37bbaf00ceb3a93ea24f1889663798f57122c610ad43135d92eb254aaa9850bf87789d84552d00e0ae92c674f425b923c3a2ecbbdb472163aa262c97c552544b0a56b878434cd114d61b979e0c67811f376a273d4a8a316a26e9f3bf5d3eb0d278f3fbc3c7a35d200c0c78e66606ba13a28ee53639e057e34750c5e8403be9148bfb8c48e6ca1e7b6678bf4de9cd2ea5a92c95cf8a1c4d1c8e9122b85148fbef0f11f314b1f3531d705ab8a5ab1e3df362dd8387f4119d7e77cb283234afa048fbf29f523177101b3cedbbb6379242959d6f3ea271bb009a9db28a5c16a89ed668219ce0f5b5d765587d486fed851dadd19d1116f81e979d431a141b6fb0c6ae49e73b9ea0b608f867a258ec5d9adb763e38dec443e381b3e3695555e6ced943690f3150714d9be25fc103df33eb6bbc0f13164f9f794a79d1bb20d18ab97d7b707e8981230d88dc17240158ac6c230e099e5d6b8b6df2ab199089c38f2dc9e782339d49d6500c2ff3c52861113b3b60330e4f462d4b7b7135df62ffe11bebc1b03725c00bad74d60b428c62504eb68083d0b7d5d8f6ad89ae2543c10f4f76e0b76ea";const salt = "428c9bc812167fed76490fae452a3f00";const main = document.querySelector("main");document.querySelector("form").addEventListener("submit", async (e) => {e.preventDefault();const password = document.querySelector("input").value;const { isSuccessful } = await handleDecryptionOfPage(password,encryptedMsg,salt,);if (!isSuccessful) {main?.classList.remove("shake");main?.offsetWidth;main?.classList.add("shake");}});</script><script src="https://cdn.twind.style" crossorigin></script><style>html{height:100%}body{display:block;height:100%;width:100%;background-color:rgb(17 24 39);color:rgb(241 245 249);font-size:1rem;line-height:1.5rem;overflow-x:hidden}@keyframes shake{0%{transform:translateX(0)}6.5%{transform:translateX(-6px) rotateY(-9deg)}18.5%{transform:translateX(5px) rotateY(7deg)}31.5%{transform:translateX(-3px) rotateY(-5deg)}43.5%{transform:translateX(2px) rotateY(3deg)}50%{transform:translateX(0)}}.shake{animation:shake 2s}</style><main class="flex h-full place-content-center place-items-center"><div class="w-[37rem] rounded bg-slate-800 px-5 py-10 shadow-xl"><h1 class="mb-2 text-3xl font-bold">Password</h1><form><label class="grid"><span class="text-slate-300 mb-1.5 mt-4">Please enter the password <strong>admin</strong></span> <input type="password" name="password" aria-label="Password" autocomplete="current-password" required autofocus class="appearance-none rounded border border-slate-400 bg-slate-900 px-3 py-2.5 focus-visible:border-teal-600 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-cyan-600"></label> <button type="submit" class="mt-4 w-full rounded bg-slate-100 py-3 font-bold text-slate-800 !bg-slate-100">Login</button></form></div></main><link rel="preload" href="https://cdn.jsdelivr.net/npm/hydro-js" as="script" crossorigin></body></html>